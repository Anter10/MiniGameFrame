{"version":3,"sources":["../../../../assets/MGFrame/assets/MGFrame/MNGConst.js"],"names":["MNGConst","restTime","crypto","require","WXSdk","appinfo","appid","wxAppId","gameid","loginUrl","admsgUrl","shareUrl","version","delItem","key","cc","sys","localStorage","removeItem","isInWXChat","wx","removeUserCloudStorage","keyList","success","msg","console","log","fail","saveItem","value","only_local","setItem","setUserCloudStorage","KVDataList","loadItem","default_value","v","getItem","share2GroupByTicket","tag","result","success_cb","fail_cb","shareTickets","call_succ","call_fail","ff","getShareInfo","shareTicket","res","iv","encryptedData","resultStr","decrypt","tywx","UserInfo","wxgame_session_key","resultObj","JSON","parse","id","openGId","t0","parseInt","tc","Date","getTime","e","getRandomShareConfigByShareTag","share_tag","config","tmp_arr","PropagateInterface","ShareConfig","hasOwnProperty","rand_idx","Math","random","length","crypted","decoded","Buffer","decipher","createDecipheriv","setAutoPadding","update","final","err","showWXToast","duration","showToast","title","icon","error","showWXModal","content","show_cancel","sure_cb","cancle_cb","showModal","showCancel","confirm","cancel","showGameClub","GameClubBtn","createGameClubButton","style","left","top","width","height","show","hideGameClub","hide","createAndcreateAndShowWXBanner","window","createBannerAd","destroyWXBanner","sys_info","getSystemInfoSync","s_w","screenWidth","s_h","screenHeight","is_ipx","ado","Utils","isIpx","is_pad","isPad","WXBannerAD","adUnitId","Constants","WXAdConfig","bannerId","onResize","IsHideBanner","hideWXBanner","showWXBanner","destroy","showWXVideo","params","createRewardedVideoAd","WXVedioAD","vedioId","onClose","toast_str","isEnded","undefined","WXVedioCallback","err_cb","error_callback","load","then","catch","lucky_rate","LuckyUserRate","module","exports"],"mappings":"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","file":"MNGConst.js","sourceRoot":"../../../../assets/MGFrame","sourcesContent":["\nvar MNGConst = {};\n\nMNGConst.restTime = 2 * 60 * 60;\n\nvar crypto = require('crypto');\n\nWXSdk.MNGConst = MNGConst;\n \nMNGConst.appinfo = {\n    appid:\"wx1271gaycadc121\",\n    wxAppId: \"wx1271gaycadc121\",\n    gameid:\"100001\",\n    loginUrl:\"\",\n    admsgUrl:\"\",\n    shareUrl:\"\",\n    version:\"100\",\n    \n};\n\n\nMNGConst.delItem = function (key) {\n    cc.sys.localStorage.removeItem(key);\n    if (!WXSdk.isInWXChat)\n        return;\n    wx.removeUserCloudStorage({\n        keyList: [key],\n        success: (msg) => {\n            console.log('removeObjectCloud  ' + key + ' succeeds', msg);\n        },\n        fail: (msg) => {\n            console.log('removeObjectCloud  ' + key + ' fails', msg);\n        },\n    });\n};\n\n/**\n * * 保存数据到本地\n *\n * @static\n * @param {String} key 标识\n * @param {any} value\n * @param {boolean} only_local 是否只保存在本地,false的情况，上传到腾讯云\n * @returns\n */\nMNGConst.saveItem = function (key, value, only_local) {\n    value = value + '';\n    cc.sys.localStorage.setItem(key, value);\n    if (!WXSdk.isInWXChat)\n        return;\n    if (!only_local) {\n        //FIXED: 做版本检测，版本低的会有黑屏\n        if (wx.setUserCloudStorage) {\n            wx.setUserCloudStorage({\n                KVDataList: [{\n                    key: key,\n                    value: value\n                }],\n                success: (msg) => {\n                    console.log('saveObjectToCloud  ' + key + ' succeeds', msg);\n                },\n                fail: (msg) => {\n                    console.log('saveObjectToCloud  ' + key + ' fails', msg);\n                },\n            });\n        }\n    }\n};\n\n/**\n * * 加载保存在本地的数据\n *\n * @static\n * @param {String} key 标识\n * @param {any} default_value 默认值\n * @returns\n */\nMNGConst.loadItem = function (key, default_value) {\n    var v = cc.sys.localStorage.getItem(key);\n    // console.log(key, 'v'+v);\n    if (!v) {\n        cc.sys.localStorage.setItem(key, default_value);\n        return default_value;\n    }\n    return v;\n};\n/**\n * @description 分享到不同群限制\n * @author lu ning\n * @date 2018-08-22\n * @static\n * @param {String} tag 分享tag\n * @param {Object} result 分享返回值\n * @param {Function} success_cb 成功回调\n * @param {Function} fail_cb 失败回调\n * @returns\n */\nMNGConst.share2GroupByTicket = function (tag, result, success_cb, fail_cb) {\n    if (!result.shareTickets || !result.shareTickets[0]) return false;\n    let call_succ = () => {\n        if (success_cb) success_cb();\n    };\n    let call_fail = () => {\n        if (fail_cb) fail_cb();\n    };\n    let ff = MNGConst;\n\n    wx.getShareInfo({\n        shareTicket: result.shareTickets[0],\n        success: (res) => {\n            console.log('isCanShare2GroupByTicket==>', res);\n            try {\n                let iv = res.iv;\n                let encryptedData = res.encryptedData;\n                let resultStr = ff.decrypt(tywx.UserInfo.wxgame_session_key, iv, encryptedData);\n                console.log('resultStr==>', resultStr);\n                if (resultStr && resultStr !== 0) {\n                    let resultObj = JSON.parse(resultStr);\n                    let id = `${tag}_${resultObj.openGId}`;\n                    let t0 = parseInt(ff.loadItem(id, 0));\n                    let tc = new Date().getTime();\n                    console.log('isCanShare2GroupByTicket==>openGId', id, typeof id);\n                    if (tc - t0 >= 24 * 60 * 60 * 1000) {\n                        ff.saveItem(id, tc, true);\n                        call_succ();\n                    } else {\n                        call_fail();\n                    }\n                } else {\n                    call_fail();\n                }\n\n            } catch (e) {\n                console.log(\"share::\", e);\n                call_fail();\n            }\n        },\n        fail: () => {\n            call_fail();\n        }\n    });\n};\n\n/**\n * @description 获取随机分享数据\n * @author lu ning\n * @date 2018-08-23\n * @static\n * @param {String} share_tag\n */\nMNGConst.getRandomShareConfigByShareTag = function (share_tag) {\n    let config = null;\n    let tmp_arr = [];\n    if (tywx.PropagateInterface.ShareConfig.hasOwnProperty(share_tag)) {\n        tmp_arr = tywx.PropagateInterface.ShareConfig[share_tag];\n        let rand_idx = parseInt(Math.random() * tmp_arr.length);\n        config = tmp_arr[rand_idx];\n    }\n    return config;\n};\n\nMNGConst.decrypt = function (key, iv, crypted) {\n    var decoded = 0;\n    try {\n        crypted = new Buffer(crypted, 'base64');\n        iv = new Buffer(iv, 'base64');\n        key = new Buffer(key, 'base64');\n\n        var decipher = crypto.createDecipheriv('aes-128-cbc', key, iv);\n        decipher.setAutoPadding(true);\n\n        decoded = decipher.update(crypted, 'binary', 'utf8');\n        decoded += decipher.final('utf8');\n    } catch (err) {\n        console.log(\"decrypt\", \" catch error: \" + err);\n    }\n    return decoded;\n};\n\n/**\n * @description \n * @author lu ning\n * @date 2018-08-24\n * @static\n * @param {String} msg\n * @param {number} [duration=1000]\n */\nMNGConst.showWXToast = function (msg, duration = 1000) {\n    if (wx.showToast) {\n        wx.showToast({\n            title: msg,\n            icon: '',\n            duration: duration\n        });\n    } else {\n        cc.error('showWXToast error can not find function wx.showToast');\n    }\n};\n/**\n * @description 显示模态窗\n * @author lu ning\n * @date 2018-08-24\n * @static\n * @param {String} content 显示内容\n * @param {String} [title='提示'] title\n * @param {boolean} [show_cancle=false]  是否显示取消\n * @param {Function} [sure_cb=null] 确定按钮回调\n * @param {Function} [cancle_cb=null] 取消按钮回调\n */\nMNGConst.showWXModal = function (content, title = '提示', show_cancel = false, sure_cb = null, cancle_cb = null) {\n    wx.showModal({\n        title: title,\n        content: content,\n        showCancel: show_cancel,\n        success: function (res) {\n            if (res.confirm) {\n                console.log('用户点击确定');\n                sure_cb && sure_cb();\n            } else if (res.cancel) {\n                console.log('用户点击取消');\n                cancle_cb && cancle_cb();\n            }\n        }\n    });\n};\n\n\n/**\n * @description 显示游戏圈\n * @author lu ning\n * @date 2018-09-05\n * @static\n */\nMNGConst.showGameClub = function() {\n    if (!GameClubBtn && wx.createGameClubButton) {\n        GameClubBtn = wx.createGameClubButton({\n            icon: 'green',\n            style: {\n                left: 10,\n                top: 30,\n                width: 40,\n                height: 40\n            }\n        });\n    }\n    GameClubBtn.show();\n}\n/**\n * @description 隐藏游戏圈\n * @author lu ning\n * @date 2018-09-05\n * @static\n */\nMNGConst.hideGameClub = function() {\n    if (GameClubBtn) {\n        GameClubBtn.hide();\n    }\n}\n\n/**\n * @description 创建并显示微信Banner广告, IsHideBanner=false到时候创建成功也不会显示\n * @author lu ning\n * @date 2018-09-06\n * @static\n * @returns\n */\nMNGConst.createAndcreateAndShowWXBanner = function() {\n    if (!window.wx) return; //! 防止浏览器中报错\n    if (!wx.createBannerAd) return; //! 玩家基础库不支持\n    MNGConst.destroyWXBanner();\n    let sys_info = wx.getSystemInfoSync();\n    let s_w = sys_info.screenWidth;\n    let s_h = sys_info.screenHeight; // 220\n    // ! 强制适配,主要是ipx有问题\n    let is_ipx = tywx.ado.Utils.isIpx();\n    // ! 强制适配 pad(宽屏设备)\n    let is_pad = tywx.ado.Utils.isPad();\n    WXBannerAD = wx.createBannerAd({\n        adUnitId: tywx.ado.Constants.WXAdConfig.bannerId,\n        style: {\n            left: 0,\n            top: 0,\n            width: is_ipx ? s_w * 0.88 : (is_pad ? s_w * 0.6 : s_w * 0.95)\n        }\n    });\n\n    try {\n        WXBannerAD.onResize(function (res) {\n            console.log('showBannerAd', '当前banner,width:' + res.width + \"; height:\" + res.height);\n            if (WXBannerAD) {\n                let top = s_h - res.height - 5; //is_ipx ? s_h - res.height + 50 : s_h - res.height - 5;\n                WXBannerAD.style.left = (s_w - res.width) / 2;\n                WXBannerAD.style.top = top;\n                //res.width             = is_ipx ? s_w * 0.8 : s_w * 0.9;\n                //res.height            = s_h * 0.13;\n            }\n        });\n    } catch (e) {\n        console.log(e);\n    }\n    // * 隐藏状态不显示banner\n    if (WXBannerAD && !IsHideBanner) WXBannerAD.show();\n}\n/**\n * @description 隐藏Banner广告,隐藏后，若需要显示，必须调用showWXBanner()\n * @author lu ning\n * @date 2018-09-06\n * @static\n */\nMNGConst.hideWXBanner = function() {\n    if (WXBannerAD) {\n        WXBannerAD.hide();\n    }\n    IsHideBanner = true;\n}\n/**\n * @description 显示Banner广告\n * @author lu ning\n * @date 2018-09-06\n * @static\n */\nMNGConst.showWXBanner = function() {\n    if (WXBannerAD) {\n        WXBannerAD.show();\n    }\n    IsHideBanner = false;\n}\n/**\n * @description 销毁Banner\n * @author lu ning\n * @date 2018-09-06\n * @static\n */\nMNGConst.destroyWXBanner= function() {\n    if (WXBannerAD) {\n        WXBannerAD.hide();\n        WXBannerAD.destroy();\n        WXBannerAD = null;\n    }\n}\n/**\n * @description 显示视频广告\n * @author lu ning\n * @date 2018-09-06\n * @static\n * @param {Object} params\n * @param {Function} params.success\n * @param {Function} params.fail\n * @param {Function} params.error_callback\n */\nMNGConst.showWXVideo = function(params) {\n    if (!window.wx) return; //! 防止浏览器中报错\n    if (!wx.createRewardedVideoAd) return; //! 玩家基础库不支持\n    if (!WXVedioAD) {\n        WXVedioAD = wx.createRewardedVideoAd({\n            adUnitId: MNGConst.vedioId\n        });\n        WXVedioAD.onClose(res => {\n            let toast_str = '';\n            if (res && res.isEnded || res === undefined) {\n                toast_str = '视频观看成功';\n                WXVedioCallback.success && WXVedioCallback.success();\n            } else {\n                toast_str = '视频观看失败';\n                WXVedioCallback.fail && WXVedioCallback.fail();\n            }\n            // tywx.ado.Utils.showWXModal(`${toast_str}`);\n            MNGConst.showWXBanner();\n        });\n    }\n    // * 成功和失败回调是变化的\n    WXVedioCallback.success = params.success;\n    WXVedioCallback.fail = params.fail;\n    WXVedioCallback.err_cb = params.error_callback || null;\n\n\n    WXVedioAD.load().then(() => WXVedioAD.show()).catch(e => {\n        console.log(e);\n        let lucky_rate = MNGConst.LuckyUserRate || 50;\n        if (Math.random() * 100 <= lucky_rate) {\n            WXVedioCallback.err_cb && WXVedioCallback.err_cb();\n        } else {\n            MNGConst.showWXModal(\"获取视频失败\");\n        }\n    });\n    MNGConst.hideWXBanner();\n}\n\nmodule.exports = MNGConst;\n"]}